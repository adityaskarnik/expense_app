{% extends 'base.html' %}
{% load static %}
{% block content %}
{% if user.is_authenticated %}

{% else %}
<script language="javascript">
    window.location.href = "/"
</script>
{% endif %}

<div class="content-wrapper">
<div class="d-flex">
        <div class="breadcrumb">
            <a href="#" class="breadcrumb-item"><i class="icon-coins mr-2"></i> Top Expenses</a>
        </div>
    
        <!-- <a href="#" class="header-elements-toggle text-default d-md-none"><i class="icon-more"></i></a> -->
    </div>
    <div class="form-group" style="display: flex; justify-content: flex-end">
        <button type="button" id="reportrange" class="btn btn-danger daterange-ranges">
            <i class="icon-calendar22 mr-2"></i>
            <span></span>
        </button>
    </div>
    <div class="row">
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-store2 icon-3x text-danger-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ food }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On Food</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-bus icon-3x text-primary-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ travel }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On Travel</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-bag icon-3x text-success-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ personal }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On Personal</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-piggy-bank icon-3x text-warning-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ savings }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On Savings</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-clapboard-play icon-3x text-info-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ entertainment }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On entertainment</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-furniture icon-3x text-pink-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ household }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On household</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-aid-kit icon-3x text-violet-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ healthcare }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On healthcare</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card card-body">
                <div class="media">
                    <div class="mr-3 align-self-center">
                        <i class="icon-phone icon-3x text-teal-400"></i>
                    </div>

                    <div class="media-body text-right">
                        <h3 class="font-weight-semibold mb-0">{{ utilities|floatformat:"2" }} ₹</h3>
                        <span class="text-uppercase font-size-sm text-muted">On Utilities</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
$(function() {

    // var start = moment().subtract(29, 'days');
    // var end = moment();

    // function cb(start, end) {
    //     $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
    // }

    // $('#reportrange').daterangepicker({
    //     startDate: start,
    //     endDate: end,
    //     ranges: {
    //     'Today': [moment(), moment()],
    //     'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
    //     'Last 7 Days': [moment().subtract(6, 'days'), moment()],
    //     'Last 30 Days': [moment().subtract(29, 'days'), moment()],
    //     'This Month': [moment().startOf('month'), moment().endOf('month')],
    //     'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
    //     }
    // }, cb);

    // cb(start, end);

    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
        const Http = new XMLHttpRequest();
        const url='/daterange?';
        // Http.open("GET", url);
        // console.log(picker.startDate.format('YYYY/MM/DD'));
        // console.log(picker.endDate.format('YYYY/MM/DD'));
        // Http.send(picker.startDate.format('YYYY/MM/DD'),picker.endDate.format('YYYY/MM/DD'));

        $.ajax({
        url: '/daterange/',
        data: {
          'startdate': picker.startDate.format('YYYY/MM/DD'),
          'enddate' : picker.endDate.format('YYYY/MM/DD')
        },
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            alert("A user with this username already exists.");
          }
        }
      });
    });
});

</script>

{% endblock %}